# リリースノート v3.4.0

**リリース日**: 2026-01-16

## 概要

v3.4.0では、新規ユーザー向けの**初回セットアップウィザード**を導入し、設定の自動検出と検証機能を実装しました。これにより、アプリケーションがより汎用的になり、学校固有の設定に依存しない形に改善されました。

## 主な新機能

### 1. 初回セットアップウィザード

初めてアプリケーションを起動したユーザーに、5ステップのガイド付きセットアップを提供します。

**ステップ構成**:
1. **ようこそ画面** - 機能の概要説明
2. **年度設定** - 現在の年度を自動推定（カスタマイズ可能）
3. **作業フォルダ設定** - Google Driveなどの作業フォルダを指定
4. **Ghostscript設定** - PDF圧縮に必要なGhostscriptを自動検出
5. **完了画面** - 設定内容の確認とサマリー表示

**特徴**:
- プログレスバーで現在のステップを表示
- リアルタイム入力検証とビジュアルフィードバック
- エラー防止のための事前チェック
- 設定完了前のレビュー機能

### 2. Ghostscript自動検出

Ghostscriptのインストールパスを手動で設定する必要がなくなりました。

**検出方法**:
- Windowsレジストリの検索（HKLM/HKCU）
- 環境変数のチェック（GS_DLL、GS_LIB）
- 標準インストールパスの探索
- PATH環境変数の検索

複数のバージョンが見つかった場合、最新版を自動的に選択します。

### 3. 設定検証システム

設定ファイルの完全性を起動時に自動チェックします。

**検証レベル**:
- **ERROR**: 必須項目が不足（アプリケーションが動作しない）
- **WARNING**: 推奨項目が不足（一部機能が制限される）
- **INFO**: 最適化の提案

問題が検出された場合、セットアップウィザードが自動的に起動します。

### 4. 設定ファイルのテンプレート化

`config.json`が汎用的なテンプレートに変更され、初回起動時にウィザードで設定を行うようになりました。

## 改善されたユーザーエクスペリエンス

### 以前（v3.3.1まで）
1. アプリケーションを起動
2. エラーメッセージが表示される（設定が不完全）
3. 手動で`config.json`を編集
4. Ghostscriptのパスを探して入力
5. 年度や作業フォルダを設定

### 現在（v3.4.0）
1. アプリケーションを起動
2. セットアップウィザードが自動的に表示
3. ガイドに従って設定を入力
4. Ghostscriptは自動検出
5. 完了 - すぐに使い始められる

## 技術的な改善

### 新規追加されたモジュール

- **ghostscript_detector.py** (260行)
  - BioPDF公式ガイドラインに準拠した自動検出ロジック
  - バージョン比較と最新版選択

- **config_validator.py** (257行)
  - 3段階の検証レベル（ERROR/WARNING/INFO）
  - 項目別の詳細なチェック

- **gui/setup_wizard.py** (650+行)
  - モーダルダイアログとして実装
  - ステップ間のナビゲーション
  - 非同期のGhostscript検出

### 変更されたファイル

- **config.json**: テンプレート化（必須項目を空に設定）
- **gui/app.py**: セットアップウィザードの統合
- **build_installer.spec**: 新規モジュールの追加

## UXベストプラクティス

このリリースは、以下のUXベストプラクティスに基づいて設計されています:

- **Kryshiggins**: "The Design of Setup Wizards"
- **LogRocket**: "Creating a Setup Wizard"
- **UX Planet**: Setup wizard patterns

**設計原則**:
- シンプルさ（5ステップ以内）
- 明確な進捗表示
- エラー防止（リアルタイム検証）
- レビューサマリー（完了前の確認）

## アップグレード方法

### 新規インストール

1. インストーラーを実行
2. 初回起動時にセットアップウィザードが表示される
3. ガイドに従って設定を完了

### 既存ユーザー（v3.3.x以前から）

既存の設定は`%LOCALAPPDATA%\PDFMergeSystem\user_config.json`に保存されているため、**アップグレード後もそのまま使用できます**。

設定を再構成したい場合:
1. `%LOCALAPPDATA%\PDFMergeSystem\user_config.json`を削除またはリネーム
2. アプリケーションを起動
3. セットアップウィザードが表示される

## 既知の問題

- セットアップウィザードで絵文字が正しく表示されない環境がある場合があります（Windows 10未満）
- ネットワークドライブを作業フォルダに指定すると、パス検証に時間がかかる場合があります

## 今後の予定

- Excel自動転記機能のセットアップウィザードへの統合
- 多言語対応（英語）
- 設定のエクスポート/インポート機能

## フィードバック

問題や改善提案がありましたら、GitHubのIssuesまでお願いします。

---

**フルチェンジログ**: [CHANGELOG.md](CHANGELOG.md)を参照してください。
